<!DOCTYPE html>
<html class="client-nojs" lang="fr" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>E-Commerce — OpenWikiBSD</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"E-Commerce","wgTitle":"E-Commerce","wgCurRevisionId":2634,"wgRevisionId":2634,"wgArticleId":310,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"fr","wgPageContentModel":"wikitext","wgSeparatorTransformTable":[",\t."," \t,"],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],"wgMonthNamesShort":["","jan","fév","mar","avr","mai","juin","juil","août","sep","oct","nov","déc"],"wgRelevantPageName":"E-Commerce","wgRelevantArticleId":310,"wgRequestId":"e673583dafed4f232f1c879b","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","user.options":"loading","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.options@1x2qlv5",function($,jQuery,require,module){mw.user.options.set({"variant":"fr"});});mw.loader.implement("user.tokens@1iezen7",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="load.php%3Fdebug=false&amp;lang=fr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor%257Cmediawiki.skinning.interface%257Cskins.vector.styles&amp;only=styles&amp;skin=vector.css"/>
<script async="" src="load.php%3Fdebug=false&amp;lang=fr&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<meta name="generator" content="MediaWiki 1.29.0"/>
<link rel="shortcut icon" href="http://www.openbsd-edu.net/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="OpenWikiBSD (fr)"/>
<link rel="EditURI" type="application/rsd+xml" href="http://www.openbsd-edu.net/api.php?action=rsd"/>
<link rel="copyright" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"/>
<link rel="alternate" type="application/atom+xml" title="Flux Atom de OpenWikiBSD" href="./index.php%3Ftitle=Sp%25C3%25A9cial:Modifications_r%25C3%25A9centes&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-E-Commerce rootpage-E-Commerce skin-vector action-view">		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators mw-body-content">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="fr">E-Commerce</h1>
									<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">De OpenWikiBSD</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Aller à :					<a href="index.php%3Ftitle=E-Commerce.html#mw-head">navigation</a>, 					<a href="index.php%3Ftitle=E-Commerce.html#p-search">rechercher</a>
				</div>
				<div id="mw-content-text" lang="fr" dir="ltr" class="mw-content-ltr"><p>Thelia, libre est une solution mature d'E-commerce apparemment.
Faisons un test pour gérer le FSE, la maison des lycéens etc..du bahut.
</p>
<div id="toc" class="toc"><div id="toctitle" class="toctitle"><h2>Sommaire</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="index.php%3Ftitle=E-Commerce.html#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="index.php%3Ftitle=E-Commerce.html#Version_stable_1.5.4"><span class="tocnumber">1.1</span> <span class="toctext">Version stable 1.5.4</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="index.php%3Ftitle=E-Commerce.html#Plugins"><span class="tocnumber">1.1.1</span> <span class="toctext">Plugins</span></a>
<ul>
<li class="toclevel-4 tocsection-4"><a href="index.php%3Ftitle=E-Commerce.html#Paypal2"><span class="tocnumber">1.1.1.1</span> <span class="toctext">Paypal2</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="index.php%3Ftitle=E-Commerce.html#Version_B.C3.A9ta_2.0"><span class="tocnumber">1.2</span> <span class="toctext">Version Béta 2.0</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="index.php%3Ftitle=E-Commerce.html#Requ.C3.AAtes_et_tables"><span class="tocnumber">2</span> <span class="toctext">Requêtes et tables</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="index.php%3Ftitle=E-Commerce.html#Requ.C3.AAtes_utiles"><span class="tocnumber">2.1</span> <span class="toctext">Requêtes utiles</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="Version_stable_1.5.4">Version stable 1.5.4</span></h3>
<p>APrès des soucis sur la 2.0 en béta, je repars sur la stable 1.5.4
</p><p>On s'inscrit puis on dl l'installeur.&#160;: <a rel="nofollow" class="external autonumber" href="http://thelia.net/">[1]</a>
</p>
<pre>apt-get install zip unzip tcpdump apache2 mysql-server php5-gd php5-mysql libapache2-mod-php5
unzip thelia.zip
chown -R www-data.www-data *
perl -pi -e 's/memory_limit = 128M/memory_limit = 150M/' /etc/php5/apache2/php.ini 
perl -pi -e 's/post_max_size = 8M/post_max_size = 20M/' /etc/php5/apache2/php.ini 
apache2ctl restart
mv client.orig client
mv template.orig template 
</pre>
<p>A la main le Mysql, ça rulez&#160;!
</p>
<pre>create database thelia;
GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,INDEX,ALTER ON thelia.* TO ADMTHELIA@localhost IDENTIFIED BY 'PASS'; 
</pre>
<p><br />
Un petit snapshot de la VM au cas où..
</p><p>Puis allez sur <a rel="nofollow" class="external free" href="http://SRV:/thelia/install/">http://SRV:/thelia/install/</a>
</p><p>N'oubliez pas de coller la bonne URL pour le site web. Dans mon cas&#160;: <a rel="nofollow" class="external free" href="http://FQDN/thelia">http://FQDN/thelia</a>&#160;!
</p><p>Lors de l'installa, le répertoire admin sera renommé en admin_XXXXXX
</p>
<pre>mv admin admin_XXXXXX et reload
</pre>
<p><br />
Puis détruisez le répertoire thelia/install après l'install
</p><p>Dans la config (admin....../lang.php), choisir l'URL du site donc, avec le sous-répertoire éventuel
</p>
<h4><span class="mw-headline" id="Plugins">Plugins</span></h4>
<h5><span class="mw-headline" id="Paypal2">Paypal2</span></h5>
<p>Attention à bien lire le readme, concernant les variables&#160;:
</p>
<pre>plugin est une version améliorée du plugin Paypal de Yoan Plugin Paypal originale version yoan, Pour l’utilisation, c’est simple il suffit d’installer le plugin comme habituellement dans Thelia, son originalité est que l’on gère et paramètre le mail du compte paypal, la devise de la monnaie et la langue de la devise via l’admin dans Configuration / Gestion des variables de votre administration thelia. 4 nouveaux champs sont crées&#160;: 
</pre>
<p>- paypal2 (votre mail du compte paypal), 
- devise_paypal2 (la devise de la monnaie, exemple EUR), 
- code_langue_paypal2 (la langue de la devise, exemple FR).
- serveur2 (serveur de connexion Paypal, par exemple).
</p>
<pre> Mode Sandbox pour les tests = <a rel="nofollow" class="external free" href="https://www.sandbox.paypal.com/cgi-bin/webscr">https://www.sandbox.paypal.com/cgi-bin/webscr</a>
 Mode Live pour la production = <a rel="nofollow" class="external free" href="https://www.paypal.com/cgi-bin/webscr">https://www.paypal.com/cgi-bin/webscr</a>
</pre>
<p>- Page de redirection vers Paypal à été personnalisation pour mieux comprendre la redirection vers la page de paiment et faire patienter l'internaute
</p><p>ATTENTION&#160;: désactiver le plugin Paypal installé en standard avant d’activer le plugin Paypal2&#160;!
</p><p><br />
</p>
<h3><span class="mw-headline" id="Version_B.C3.A9ta_2.0">Version Béta 2.0</span></h3>
<p>On s'inscrit puis on dl l'installeur.&#160;: <a rel="nofollow" class="external autonumber" href="http://thelia.net/">[2]</a>
</p>
<pre>apt-get install zip unzip tcpdump apache2 mysql-server php5-gd php5-mysql libapache2-mod-php5
unzip thelia.zip
chmod 777 cache/
chmod 777 log/  
 chmod 777 /var/www/thelia/local/config
chmod 777 /var/www/thelia/web
chmod 777 /var/www/thelia/local/session 
perl -pi -e 's/memory_limit = 128M/memory_limit = 150M/' /etc/php5/apache2/php.ini 
perl -pi -e 's/post_max_size = 8M/post_max_size = 20M/' /etc/php5/apache2/php.ini 
apache2ctl restart
</pre>
<p>A la main le Mysql, ça rulez&#160;!
</p><p><br />
Un petit snapshot de la VM au cas où..
</p><p>Puis allez sur <a rel="nofollow" class="external free" href="http://SRV:/thelia/web/install/">http://SRV:/thelia/web/install/</a>
</p><p>N'oubliez pas de coller la bonne URL pour le site web. Dans mon cas&#160;: <a rel="nofollow" class="external free" href="http://FQDN/thelia">http://FQDN/thelia</a>&#160;!
</p><p><br />
Puis détruisez le repértoire thelia/web/install après l'install
</p><p><br />
</p>
<h2><span class="mw-headline" id="Requ.C3.AAtes_et_tables">Requêtes et tables</span></h2>
<p>Lors d'une commande, les tables suivantes sont impactées&#160;:
</p>
<ul><li> commande (1 enregistrement par commande)</li>
<li> venteadr  autant d'enregistrements que de produits commandés</li>
<li> venteprod  autant d'enregistrements que de produits commandés</li>
<li> produit pour mettre à jour le stock</li></ul>
<p>La jointure se fait par venteprod.commande=commande.id
</p>
<h3><span class="mw-headline" id="Requ.C3.AAtes_utiles">Requêtes utiles</span></h3>
<ul><li> Sélectionner tous les clients ayant commandé un type d'article, le 7,ici&#160;:</li></ul>
<pre>select distinct  nom,prenom,entreprise,produit.ref from venteprod,commande,client,produit   where commande.id=venteprod.commande and client.id=commande.client and produit.id=7;
</pre>
<ul><li> Mettre à jour les stocks:</li></ul>
<pre>update produit set stock=99999 where id&gt;5;
</pre>
<ul><li> Total de chaque produit commandé&#160;:</li></ul>
<pre> select produit.ref,  count( distinct  nom,prenom,entreprise,produit.ref) from venteprod,commande,client,produit   where commande.id=venteprod.commande and client.id=commande.client and produit.id=49;
</pre>
<ul><li> Ensemble des commandes par client</li></ul>
<pre>select distinct client.prenom,client.nom,client.entreprise,venteprod.ref from commande,client,venteprod where commande.client=client.id and venteprod.commande=commande.id order by venteprod.ref;
</pre>
<!-- 
NewPP limit report
Cached time: 20171019162931
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.060 seconds
Real time usage: 0.059 seconds
Preprocessor visited node count: 27/1000000
Preprocessor generated node count: 32/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key WikiBSD:pcache:idhash:310-0!*!*!!fr!*!* and timestamp 20171019162931 and revision id 2634
 -->
</div>					<div class="printfooter">
						Récupérée de «&#160;<a dir="ltr" href="http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;oldid=2634">http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;oldid=2634</a>&#160;»					</div>
				<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Menu de navigation</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Outils personnels</h3>
						<ul>
							<li id="pt-login"><a href="./index.php%3Ftitle=Sp%25C3%25A9cial:Connexion&amp;returnto=E-Commerce.html" title="Il est recommandé de vous identifier ; ce n'est cependant pas obligatoire. [o]" accesskey="o">Se connecter</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Espaces de noms</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="index.php%3Ftitle=E-Commerce.html"  title="Voir la page de contenu [c]" accesskey="c">Page</a></span></li>
															<li  id="ca-talk" class="new"><span><a href="http://www.openbsd-edu.net/index.php?title=Discussion:E-Commerce&amp;action=edit&amp;redlink=1"  title="Discussion au sujet de cette page de contenu [t]" accesskey="t" rel="discussion">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label">
							<span>Variantes</span><a href="index.php%3Ftitle=E-Commerce.html#"></a>
						</h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Affichages</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="index.php%3Ftitle=E-Commerce.html" >Lire</a></span></li>
															<li id="ca-viewsource"><span><a href="http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;action=edit"  title="Cette page est protégée.&#10;Vous pouvez toutefois en visualiser la source. [e]" accesskey="e">Voir le texte source</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;action=history"  title="Les versions passées de cette page (avec leurs contributeurs) [h]" accesskey="h">Historique</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>Plus</span><a href="index.php%3Ftitle=E-Commerce.html#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Rechercher</label>
						</h3>

						<form action="http://www.openbsd-edu.net/index.php" id="searchform">
							<div id="simpleSearch">
							<input type="search" name="search" placeholder="Rechercher sur OpenWikiBSD" title="Rechercher dans OpenWikiBSD [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Spécial:Recherche" name="title"/><input type="submit" name="fulltext" value="Rechercher" title="Rechercher les pages comportant ce texte." id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Lire" title="Aller vers une page portant exactement ce nom si elle existe." id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="index.php%3Ftitle=Accueil.html"  title="Page principale"></a></div>
						<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
			<h3 id='p-navigation-label'>Navigation</h3>

			<div class="body">
									<ul>
						<li id="n-mainpage-description"><a href="index.php%3Ftitle=Accueil.html" title="Aller à l'accueil [z]" accesskey="z">Accueil</a></li><li id="n-recentchanges"><a href="./index.php%3Ftitle=Sp%25C3%25A9cial:Modifications_r%25C3%25A9centes.html" title="Liste des modifications récentes sur le wiki [r]" accesskey="r">Modifications récentes</a></li><li id="n-randompage"><a href="./index.php%3Ftitle=Sp%25C3%25A9cial:Page_au_hasard.html" title="Afficher une page au hasard [x]" accesskey="x">Page au hasard</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="Aide">Aide</a></li>					</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Outils</h3>

			<div class="body">
									<ul>
						<li id="t-whatlinkshere"><a href="./index.php%3Ftitle=Sp%25C3%25A9cial:Pages_li%25C3%25A9es%252FE-Commerce.html" title="Liste des pages liées qui pointent sur celle-ci [j]" accesskey="j">Pages liées</a></li><li id="t-recentchangeslinked"><a href="http://www.openbsd-edu.net/index.php?title=Sp%C3%A9cial:Suivi_des_liens/E-Commerce" rel="nofollow" title="Liste des modifications récentes des pages appelées par celle-ci [k]" accesskey="k">Suivi des pages liées</a></li><li id="t-specialpages"><a href="./index.php%3Ftitle=Sp%25C3%25A9cial:Pages_sp%25C3%25A9ciales.html" title="Liste de toutes les pages spéciales [q]" accesskey="q">Pages spéciales</a></li><li id="t-print"><a href="http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;printable=yes" rel="alternate" title="Version imprimable de cette page [p]" accesskey="p">Version imprimable</a></li><li id="t-permalink"><a href="http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;oldid=2634" title="Adresse permanente de cette version de la page">Adresse permanente</a></li><li id="t-info"><a href="http://www.openbsd-edu.net/index.php?title=E-Commerce&amp;action=info" title="Plus d’information sur cette page">Information sur la page</a></li>					</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> Cette page a été modifiée pour la dernière fois le 31 mars 2014 à 21:06.</li>
											<li id="footer-info-copyright">Le contenu est disponible sous licence <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons paternité – non commercial – partage à l’identique</a> sauf mention contraire.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="http://www.openbsd-edu.net/index.php?title=OpenWikiBSD:Confidentialit%C3%A9" title="OpenWikiBSD:Confidentialité">Politique de confidentialité</a></li>
											<li id="footer-places-about"><a href="http://www.openbsd-edu.net/index.php?title=OpenWikiBSD:%C3%80_propos" title="OpenWikiBSD:À propos">À propos de OpenWikiBSD</a></li>
											<li id="footer-places-disclaimer"><a href="http://www.openbsd-edu.net/index.php?title=OpenWikiBSD:Avertissements_g%C3%A9n%C3%A9raux" title="OpenWikiBSD:Avertissements généraux">Avertissements</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
							<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="resources/assets/licenses/cc-by-nc-sa.png" alt="Creative Commons paternité – non commercial – partage à l’identique" width="88" height="31"/></a>						</li>
											<li id="footer-poweredbyico">
							<a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="resources/assets/poweredby_mediawiki_132x47.png 1.5x, resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>						</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.060","walltime":"0.059","ppvisitednodes":{"value":27,"limit":1000000},"ppgeneratednodes":{"value":32,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20171019162931","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":1350});});</script>
	</body>
</html>
